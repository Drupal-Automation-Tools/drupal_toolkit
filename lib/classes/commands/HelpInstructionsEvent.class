<?php
/**
 * @file Defines the HelpInstructionsEvent class.
 */

/**
 * An event that is fired to retrieve help instructions.
 * 
 * @ingroup event_objects
 */
class HelpInstructionsEvent extends DtkEvent {
  
  /**
   * An array of HelpInstruction objects.
   * 
   * @var array
   */
  private $instructions = array();
  
  /**
   * Registers a HelpInstruction object with the event.
   * 
   * @param HelpInstructions $instructions
   *   The instruction to register.
   */
  public function registerInstruction(HelpInstructions $instructions) {
    $this->instructions[$instructions->getCommandName()] = $instructions;
    $this->setResult(TRUE);
  }
  
  public function defineOptions($module, $option, $description, $aliases = array()) {
    if (empty($module)) {
      $module = array_keys($this->instructions);
    }
    elseif (!is_array($module)) {
      $module = array($module);
    }
    foreach ($module as $m) {
      if (isset($this->instructions[$m])) {
        $this->instructions[$m]->defineOption($option, $description, $aliases);
      }
    }
  }
  
  /**
   * Retrieves an array of all instructions.
   * 
   * @return array
   *   An array of HelpInstruction objects.
   */
  public function getInstructions() {
    ksort($this->instructions);
    return $this->instructions;
  }
  
  /**
   * Retrieves a single instruction object by name.
   * 
   * @param string $commandName
   *   The primary name of the command.
   * 
   * @return HelpInstructions
   *   A help instruction object associated with the command, or NULL if
   *   none was found.
   */
  public function findInstructions($commandName) {
    if (isset($this->instructions[$commandName])) {
      return $this->instructions[$commandName];
    }
    // @todo look through the aliases and return one if it matches $commandName
    return NULL;
  }
  
}