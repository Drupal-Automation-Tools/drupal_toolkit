<?php
/**
 * @file Defines the DrupalSiteDoxygenPlugin class.
 */

/**
 * Responsible for registering the SiteDoxygenCommand command.
 */
class DrupalSiteDocumentationPlugin extends GenericPlugin implements EventListener {
  
  public function initialize() {
    $this->events()->registerListener(array(
      EVENT_CORE_REGISTER_COMMANDS,
      EVENT_FIND_HELP_INSTRUCTIONS,
    ), $this);
  }
  
  public function captureEvent(DtkEvent &$event, $type) {
    switch ($type) {
      case EVENT_FIND_HELP_INSTRUCTIONS:
        if ($event instanceof HelpInstructionsEvent) {
          $docs = new HelpInstructions(
            $this->str(STRING_HELP_DSM_CATEGORY),
            'site-doc',
            $this->str(STRING_HELP_SITE_DOC_DESCRIPTION)
          );
          $docs->defineArgument(1, $this->str(STRING_HELP_SITE_NAME));
          $event->registerInstruction($docs);
        }
        break;
      case EVENT_CORE_REGISTER_COMMANDS:
        $this->router()->addCommand('site-doc', new SiteDocumentationCommand());
        break;
    }
  }
  
}