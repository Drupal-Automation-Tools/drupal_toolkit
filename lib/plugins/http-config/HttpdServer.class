<?php
/**
 * @file Defines the HttpdServer class.
 */

/**
 * Implements HttpServerInterface for HTTPD.
 */
class HttpdServer extends GenericHttpServer {
  
  /**
   * The server we're wrapping.
   * 
   * @param PhysicalServerInterface $server
   *   The server we're wrapping.
   */
  public function __construct(PhysicalServerInterface $server) {
    parent::__construct($server, '/etc/httpd/conf.d');
  }
  
  private function useSudo() {
    $noSudo = $this->machine()->getSetting(SERVER_SETTING_NO_SUDO_COMMANDS);
    return empty($noSudo);
  }
  
  protected function reboot() {
    $command = ($this->useSudo() ? 'sudo ' : '') . 'service httpd graceful';
    $this->machine()->executeCommand($command, array(), $n, $exit);
    return empty($exit);
  }
  
  protected function testConfig() {
    $command = ($this->useSudo() ? 'sudo ' : '') . 'service httpd configtest';
    $this->machine()->executeCommand($command, array(), $n, $exit);
    return empty($exit);
  }
  
  public function available() {
    $command = ($this->useSudo() ? 'sudo ' : '') . 'service httpd status';
    $this->machine()->executeCommand($command, array(), $n, $exit);
    return empty($exit);
  }
  
}